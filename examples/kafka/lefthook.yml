kafka:
  piped: true
  commands:
    1_build:
      run: CI_JOB_ID=$CI_JOB_ID docker-compose -f docker/docker-compose.yml build
    2_kafka_up:
      run: CI_JOB_ID=$CI_JOB_ID docker-compose -f docker/docker-compose.yml up -d kafka

down:
  piped: true
  commands:
    4_down:
      run: CI_JOB_ID=$CI_JOB_ID docker-compose -f docker/docker-compose.yml down

develop:
  piped: true
  commands:
    1_build:
      run: CI_JOB_ID=$CI_JOB_ID docker-compose -f docker/docker-compose.yaml build
    2_haproxy_up:
      run: CI_JOB_ID=$CI_JOB_ID docker-compose -f docker/docker-compose.yaml up -d haproxy
    3_manager_up:
      run: CI_JOB_ID=$CI_JOB_ID docker-compose -f docker/docker-compose.yaml run --rm --name manager --entrypoint "tail -f /dev/null" -d -v `pwd`:/development manager
    4_connect:
      run: docker exec -it manager /bin/bash
    4_down:
      run: CI_JOB_ID=$CI_JOB_ID docker-compose -f docker/docker-compose.yaml down
